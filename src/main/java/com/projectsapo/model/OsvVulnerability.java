/*
 * Copyright (c) 2026 Luis Paolo Pepe Barra (@LuisPPB16).
 * All rights reserved.
 */

package com.projectsapo.model;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;
import java.util.List;
import java.util.Map;

/** Represents a single vulnerability record from OSV. */
@JsonIgnoreProperties(ignoreUnknown = true)
public record OsvVulnerability(
    String id,
    String summary,
    String details,
    List<Severity> severity,
    List<Affected> affected,
    List<Reference> references,
    @JsonProperty("database_specific") Map<String, Object> databaseSpecific) {
  @JsonIgnoreProperties(ignoreUnknown = true)
  public record Severity(String type, String score) {}

  @JsonIgnoreProperties(ignoreUnknown = true)
  public record Affected(
      @JsonProperty("package") Package pkg,
      List<Range> ranges,
      List<String> versions,
      @JsonProperty("database_specific") Map<String, Object> databaseSpecific) {}

  @JsonIgnoreProperties(ignoreUnknown = true)
  public record Package(String name, String ecosystem, String purl) {}

  @JsonIgnoreProperties(ignoreUnknown = true)
  public record Range(String type, List<Event> events) {}

  @JsonIgnoreProperties(ignoreUnknown = true)
  public record Event(String introduced, String fixed) {}

  @JsonIgnoreProperties(ignoreUnknown = true)
  public record Reference(String type, String url) {}
}
