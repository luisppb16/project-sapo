package com.projectsapo.model;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import java.util.List;

/**
 * Represents a single vulnerability record from OSV.
 *
 * @param id The OSV ID of the vulnerability.
 * @param summary A short summary of the vulnerability.
 * @param details Detailed description of the vulnerability.
 * @param affected List of affected packages and versions.
 * @param references List of references/links related to the vulnerability.
 */
@JsonIgnoreProperties(ignoreUnknown = true)
public record OsvVulnerability(
        String id,
        String summary,
        String details,
        List<Affected> affected,
        List<Reference> references
) {
    @JsonIgnoreProperties(ignoreUnknown = true)
    public record Affected(
            List<Range> ranges
    ) {}

    @JsonIgnoreProperties(ignoreUnknown = true)
    public record Range(
            String type,
            List<Event> events
    ) {}

    @JsonIgnoreProperties(ignoreUnknown = true)
    public record Event(
            String introduced,
            String fixed
    ) {}

    @JsonIgnoreProperties(ignoreUnknown = true)
    public record Reference(
            String type,
            String url
    ) {}
}
